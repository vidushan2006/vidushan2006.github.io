<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Private Classes</title>

  <!-- Primary external CSS (keep this file in the same folder) -->
  <link rel="stylesheet" href="private.css" id="private-css-link">

  <!-- Inline small script to detect whether CSS actually applied.
       If it didn't load (file missing or file:// issues), the script injects a fallback CSS identical to private.css.
       This preserves the requirement of using a separate CSS file while guaranteeing the page will not remain unstyled. -->
  <script>
    // Wait until DOM is ready enough to measure styles.
    (function() {
      // CSS fallback content (same as private.css). If you update private.css, keep this sync'd.
      const fallbackCSS = `/* FALLBACK CSS: keep in sync with private.css */
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
  background-image:url('assets/images/background.gif');
  background-size:cover;
  background-position:center;
  background-attachment:fixed;
  color:#e6f3ea;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  line-height:1.35;
}

/* Topbar */
.topbar{position:fixed;inset:0 0 auto 0;z-index:120;background:linear-gradient(180deg,rgba(8,10,10,0.45),rgba(8,10,10,0.18));backdrop-filter:blur(6px) saturate(120%);border-bottom:1px solid rgba(255,255,255,0.03);box-shadow:0 6px 20px rgba(0,0,0,0.6)}
.topbar-inner{max-width:1200px;margin:0 auto;padding:12px 20px;display:flex;justify-content:space-between;align-items:center;gap:12px}
.left{display:flex;align-items:center;gap:14px}
.logo{width:46px;height:46px;object-fit:cover;border-radius:6px;box-shadow:0 8px 26px rgba(0,0,0,0.6)}
.home-link{display:inline-block}
.main-nav{display:flex;gap:10px;align-items:center}
.nav-item{color:#dceee1;text-decoration:none;padding:8px 10px;font-weight:700;border-radius:6px;font-size:14px;background:transparent}
.nav-item:hover{transform:translateY(-2px);transition:transform 160ms ease}
.nav-button{cursor:pointer;border:none;background:rgba(255,255,255,0.03);color:inherit}

/* Signin button */
.right{display:flex;align-items:center}
.signin{background:linear-gradient(180deg,#ff7a7a,#ff5860);color:white;border:none;padding:8px 14px;border-radius:8px;font-weight:800;cursor:pointer;box-shadow:0 8px 20px rgba(255,90,90,0.12)}

/* Main hero container */
.page{margin-top:100px;min-height:calc(100vh - 120px)}
.hero .container{max-width:1200px;margin:0 auto;padding:28px}

/* Title and subtitle */
.title{font-size:42px;color:#fff;text-shadow:0 8px 36px rgba(0,0,0,0.65);margin-bottom:8px;font-weight:800}
.subtitle{color:rgba(230,240,230,0.78);margin-bottom:28px;font-size:15px}

/* Tiles grid */
.tiles{display:grid;grid-template-columns:repeat(2,1fr);gap:18px}
@media (min-width:1200px){.tiles{grid-template-columns:repeat(4,1fr);gap:22px}}
@media (min-width:900px) and (max-width:1199px){.tiles{grid-template-columns:repeat(3,1fr);gap:20px}}
@media (max-width:620px){.tiles{grid-template-columns:1fr;gap:14px;padding-bottom:16px}}

/* Card */
.card{display:block;background:linear-gradient(180deg,rgba(0,0,0,0.7),rgba(0,0,0,0.45));border-radius:10px;overflow:hidden;border:3px solid rgba(255,255,255,0.06);cursor:pointer;text-align:center;box-shadow:0 20px 40px rgba(0,0,0,0.65);transition:transform .22s cubic-bezier(.2,.9,.2,1),box-shadow .22s}
.card:focus{outline:3px solid rgba(10,200,140,0.12)}
.card:hover{transform:translateY(-8px);box-shadow:0 34px 60px rgba(0,0,0,0.75)}

/* Media area */
.card-media{position:relative;width:100%;height:260px;background:#000;display:block;overflow:hidden}
@media (max-width:720px){.card-media{height:200px}}
.card-media img{width:100%;height:100%;object-fit:cover;transform:scale(1.03);filter:saturate(1.1) contrast(1.05);display:block}

/* Neon overlay text */
.neon{position:absolute;left:0;right:0;bottom:26px;text-align:center;font-weight:900;letter-spacing:6px;font-size:64px;color:#00ff3a;text-shadow:0 0 6px rgba(0,255,120,0.9),0 0 20px rgba(0,255,120,0.4),0 16px 30px rgba(0,0,0,0.6);mix-blend-mode:screen;pointer-events:none;transform:translateZ(0)}
@media (max-width:720px){.neon{font-size:38px;bottom:18px;letter-spacing:4px}}

/* Reflection copy */
.neon-reflect{position:absolute;left:0;right:0;bottom:-32px;text-align:center;font-weight:900;font-size:64px;color:rgba(0,255,120,0.22);filter:blur(6px);transform:scaleY(-1);opacity:0.28;pointer-events:none;mix-blend-mode:screen}
@media (max-width:720px){.neon-reflect{font-size:38px;bottom:-26px}}

/* Caption area */
.card-caption{padding:8px 10px 14px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01))}
.card-title{font-size:14px;font-weight:800;color:#eaf8ea;margin-bottom:6px}
.card-type{font-size:11px;color:rgba(180,255,200,0.9);font-weight:700;text-transform:uppercase}

/* Footer */
copyright, .copyright{margin-top:28px;text-align:center;color:rgba(255,255,255,0.82);font-size:13px;text-shadow:0 1px 0 rgba(0,0,0,0.6)}

/* Modal */
.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(8,8,8,0.62);z-index:300;padding:18px}
.modal.hidden{display:none}
.modal-content{width:100%;max-width:420px;border-radius:12px;background:linear-gradient(180deg,rgba(12,14,12,0.96),rgba(8,10,8,0.94));padding:18px;box-shadow:0 20px 60px rgba(0,0,0,0.7);position:relative}
.modal-close{position:absolute;top:10px;right:10px;background:transparent;border:none;color:#ddd;font-size:18px;cursor:pointer}
.modal-body{text-align:center;padding-top:4px}
.pw-thumb{width:120px;height:72px;object-fit:cover;border-radius:6px;margin:8px auto;box-shadow:0 12px 30px rgba(0,0,0,0.6)}
.pw-input{width:100%;padding:12px 14px;margin-top:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:rgba(255,255,255,0.02);color:#fff;font-size:15px}
.pw-actions{display:flex;gap:8px;justify-content:center;margin-top:12px}
.btn{padding:10px 14px;border-radius:8px;border:none;font-weight:800;cursor:pointer;background:linear-gradient(180deg,#00d07a,#00b66a);color:white}
.btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:#dfeee1}
.pw-error{color:#ff7b7b;margin-top:10px}

/* Viewer */
.viewer{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(6,6,6,0.78);z-index:400;padding:18px}
.viewer.hidden{display:none}
.viewer-inner{width:100%;max-width:1100px;height:72vh;border-radius:12px;overflow:hidden;background:rgba(2,2,2,0.7);box-shadow:0 28px 80px rgba(0,0,0,0.8);position:relative}
.viewer-close{position:absolute;top:10px;right:10px;background:transparent;border:none;color:#ddd;font-size:20px;z-index:5;cursor:pointer}
.iframe-wrap iframe{width:100%;height:100%;border:0;display:block}
@media (max-width:480px){.topbar-inner{padding:10px 12px}.title{font-size:28px}.neon{font-size:28px;letter-spacing:4px;bottom:16px}.card-media{height:180px}}`;

      // small helper: check if the computed background image contains the background gif
      function cssAppliedCheck(){
        try {
          const body = document.body;
          const comp = window.getComputedStyle(body).backgroundImage || '';
          // If the external CSS loaded, backgroundImage should reference assets/images/background.gif
          return comp && comp.indexOf('background.gif') !== -1;
        } catch(e){
          return false;
        }
      }

      // After a short delay check whether required CSS applied. If not, inject fallback.
      window.addEventListener('load', function() {
        setTimeout(function(){
          if(!cssAppliedCheck()){
            // inject fallback style block (so even if external file fails, layout looks right)
            const style = document.createElement('style');
            style.id = 'private-css-fallback';
            style.appendChild(document.createTextNode(fallbackCSS));
            document.head.appendChild(style);
            console.warn('private.css did not appear to load — fallback CSS injected. Ensure private.css exists and is accessible at same directory as private.html.');
          } else {
            // CSS loaded normally
          }
        }, 180);
      });
    })();
  </script>
</head>
<body>
  <!-- Top bar -->
  <header class="topbar" role="banner">
    <div class="topbar-inner">
      <div class="left">
        <a class="home-link" href="index.html" aria-label="Home">
          <img class="logo" src="assets/images/avatar-small.png" alt="logo">
        </a>
        <nav class="main-nav" aria-label="Primary navigation">
          <a class="nav-item" href="index.html">Home</a>
          <a class="nav-item" href="about.html">About</a>
          <button id="nav-private" class="nav-item nav-button" title="Private">Private</button>
        </nav>
      </div>

      <div class="right">
        <button id="signin-google" class="signin">Sign in with Google</button>
      </div>
    </div>
  </header>

  <!-- Main content -->
  <main class="page" role="main">
    <section class="hero">
      <div class="container">
        <h1 class="title">Private Classes</h1>
        <p class="subtitle">To access Enter the password or sign in with a Google account that has admin access</p>

        <section id="tiles" class="tiles" aria-live="polite">
          <!-- Cards injected by JS -->
        </section>

        <footer class="copyright">© VIDU. All rights reserved.</footer>
      </div>
    </section>
  </main>

  <!-- Password modal -->
  <div id="pw-modal" class="modal hidden" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal-content" role="document">
      <button class="modal-close" id="pw-close" aria-label="Close">✕</button>
      <div class="modal-body">
        <img id="pw-thumb" class="pw-thumb" alt="">
        <h2 id="pw-title">Enter password</h2>
        <input id="pw-input" class="pw-input" type="password" placeholder="Password" />
        <div class="pw-actions">
          <button id="pw-submit" class="btn">Unlock</button>
          <button id="pw-cancel" class="btn btn-ghost">Cancel</button>
        </div>
        <p id="pw-error" class="pw-error" role="status" aria-live="assertive"></p>
      </div>
    </div>
  </div>

  <!-- Viewer overlay for video/playlist -->
  <div id="viewer" class="viewer hidden" aria-hidden="true">
    <div class="viewer-inner">
      <button class="viewer-close" id="viewer-close" aria-label="Close viewer">✕</button>
      <div class="iframe-wrap" id="iframe-wrap" aria-live="polite"></div>
    </div>
  </div>

<script>
/* ---------- Data: items array (uses btoa as requested) ---------- */
const items = [
  { type: 'video', title: 'TEST', thumb: 'https://i.pinimg.com/736x/e9/f1/5d/e9f15d10baf0131ab65bdc35d620adce.jpg', idB64: btoa("Lexok6H2c2s"), passB64: btoa("vidu123test")},
  { type: 'playlist', title: 'SFT - Theory + Revision', thumb: 'https://i.pinimg.com/736x/b8/de/57/b8de57f639bb30fd9f48cda542dd96d2.jpg', idB64: btoa("PL9zX0VbNmKiGt19HZ9wzIwC-VQ_AN0z9K&si=0jJc5HTa68Weq851"), passB64: btoa("vidu123sft") },
  { type: 'playlist', title: 'ICT', thumb: 'https://i.pinimg.com/736x/81/f4/0d/81f40de2906f0c61f2f17d6db61d7271.jpg', idB64: btoa("PL9zX0VbNmKiFlxda5PCTn4_hA_7iKjEaA&si=9nF_7qpAzKt4cYZd"), passB64: btoa("6002vidu") },
  { type: 'playlist', title: 'ET', thumb: 'https://i.pinimg.com/736x/19/b2/42/19b2424009813fc558e8a785c794cbdf.jpg', idB64: btoa("PL9zX0VbNmKiF-Q7bnmM1v_DrT3_Ol-Of5&si=efJHPzWR-kZcGwYw"), passB64: btoa("vidu123et")}
];

/* ---------- DOM refs ---------- */
const tiles = document.getElementById('tiles');
const pwModal = document.getElementById('pw-modal');
const pwTitle = document.getElementById('pw-title');
const pwThumb = document.getElementById('pw-thumb');
const pwInput = document.getElementById('pw-input');
const pwSubmit = document.getElementById('pw-submit');
const pwCancel = document.getElementById('pw-cancel');
const pwClose = document.getElementById('pw-close');
const pwError = document.getElementById('pw-error');
const viewer = document.getElementById('viewer');
const iframeWrap = document.getElementById('iframe-wrap');
const viewerClose = document.getElementById('viewer-close');
let currentItem = null;

/* ---------- Utilities ---------- */
function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

/* ---------- Build cards ---------- */
function buildTiles(){
  tiles.innerHTML = '';
  items.forEach((it, idx) => {
    const card = document.createElement('button');
    card.className = 'card';
    card.type = 'button';
    card.setAttribute('data-idx', idx);
    card.setAttribute('aria-label', `${it.title} (${it.type})`);
    let neonText = it.title.split(/\s+/)[0].toUpperCase();
    card.innerHTML = `
      <div class="card-media">
        <img src="${it.thumb}" alt="${escapeHtml(it.title)} thumbnail" loading="lazy" />
        <div class="neon">${escapeHtml(neonText)}</div>
        <div class="neon-reflect" aria-hidden="true">${escapeHtml(neonText)}</div>
      </div>
      <div class="card-caption">
        <div class="card-title">${escapeHtml(it.title)}</div>
        <div class="card-type">${escapeHtml(it.type.toUpperCase())}</div>
      </div>
    `;
    card.addEventListener('click', () => openPasswordModal(it));
    tiles.appendChild(card);
  });
}

/* ---------- Password modal ---------- */
function openPasswordModal(item){
  currentItem = item;
  pwError.textContent = '';
  pwInput.value = '';
  pwTitle.textContent = `Unlock: ${item.title}`;
  pwThumb.src = item.thumb;
  pwThumb.alt = item.title + ' thumbnail';
  showModal(pwModal);
  setTimeout(()=> pwInput.focus(), 120);
}
pwSubmit.addEventListener('click', verifyPassword);
pwInput.addEventListener('keydown', (e) => { if(e.key === 'Enter') verifyPassword(); });
pwCancel.addEventListener('click', () => closeModal(pwModal));
pwClose.addEventListener('click', () => closeModal(pwModal));

function verifyPassword(){
  if(!currentItem) return;
  const entered = pwInput.value || '';
  try {
    const enteredB64 = btoa(entered);
    if(enteredB64 === currentItem.passB64){
      closeModal(pwModal);
      openViewer(currentItem);
    } else {
      pwError.textContent = 'Incorrect password. Try again.';
      pwInput.select();
    }
  } catch(err){
    pwError.textContent = 'Error checking password.';
  }
}

/* ---------- Viewer (iframe) ---------- */
function openViewer(item){
  iframeWrap.innerHTML = '';
  const id = atob(item.idB64);
  let src = '';
  if(item.type === 'video'){
    src = 'https://www.youtube.com/embed/' + encodeURIComponent(id) + '?rel=0&autoplay=1';
  } else {
    src = 'https://www.youtube.com/embed?listType=playlist&list=' + encodeURIComponent(id) + '&rel=0&autoplay=1';
  }
  const ifr = document.createElement('iframe');
  ifr.setAttribute('src', src);
  ifr.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share');
  ifr.setAttribute('allowfullscreen', '');
  iframeWrap.appendChild(ifr);
  showModal(viewer);
}
viewerClose.addEventListener('click', () => { closeModal(viewer); iframeWrap.innerHTML = ''; });

/* ---------- Modal helpers ---------- */
function showModal(el){
  el.classList.remove('hidden');
  el.setAttribute('aria-hidden', 'false');
  document.body.style.overflow = 'hidden';
}
function closeModal(el){
  el.classList.add('hidden');
  el.setAttribute('aria-hidden', 'true');
  document.body.style.overflow = '';
}

/* Close by clicking outside content or pressing Escape */
pwModal.addEventListener('click', (e) => { if(e.target === pwModal) closeModal(pwModal); });
viewer.addEventListener('click', (e) => { if(e.target === viewer) { closeModal(viewer); iframeWrap.innerHTML = ''; }});
document.addEventListener('keydown', (e) => {
  if(e.key === 'Escape') {
    if(!pwModal.classList.contains('hidden')) closeModal(pwModal);
    if(!viewer.classList.contains('hidden')) { closeModal(viewer); iframeWrap.innerHTML = ''; }
  }
});

/* ---------- Private button behaviour ---------- */
document.getElementById('nav-private').addEventListener('click', () => {
  localStorage.setItem('hideSignIn', '1');
  location.reload();
});

/* ---------- Sign-in button: hide if flag present ---------- */
window.addEventListener('load', () => {
  const hide = localStorage.getItem('hideSignIn') === '1';
  const signinBtn = document.getElementById('signin-google');
  if(hide && signinBtn) {
    signinBtn.remove();
  } else if(signinBtn) {
    signinBtn.addEventListener('click', ()=> alert('Mock Google sign-in (replace with real flow).'));
  }
  buildTiles();
});
</script>
</body>
</html>
