<!DOCTYPE HTML>
<html>
<head>
  <title>VIDU</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <link rel="stylesheet" href="assets/css/main.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg-overlay: rgba(4,6,12,0.46);
      --glass: rgba(255,255,255,0.04);
      --glass-strong: rgba(255,255,255,0.06);
      --accent-1: #7b61ff;
      --accent-2: #39ff14; /* green for seek/volume fill / thumb */
      --accent-3: #ff6b6b;
      --muted: #bfc8dd;
      --text: #f2f6ff;
      --card-radius: 10px;
      --ease: cubic-bezier(.16,.84,.24,1);
    }

    body{
      /* PERFORMANCE: Replaced heavy GIF background with a static image */
      background: url('assets/images/background.png') no-repeat center center fixed;
      background-size: cover;
      background-color: #04060c; /* Fallback color */
      font-family:"Inter","Helvetica Neue",Arial,sans-serif;
      color:var(--text);
      margin:0;
      min-height:100vh;
      position:relative;
      overflow-x:hidden;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    body::before{
      content:'';
      position:fixed;
      inset:0;
      background:linear-gradient(180deg, rgba(0,0,0,0.18), rgba(0,0,0,0.38));
      pointer-events:none;
      z-index:0;
    }

    #wrapper{position:relative;z-index:3;padding-bottom:48px;}

    header#header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:14px 22px;
      /* PERFORMANCE: Replaced expensive backdrop-filter with a simple transparent background */
      background:rgba(12, 14, 20, 0.7);
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      border-radius:0 0 10px 10px;
      z-index:4;
      position:relative;
      box-shadow:0 8px 30px rgba(2,4,12,0.5);
    }

    .header-right-controls {
        display: flex;
        align-items: center;
        gap: 16px;
    }

    .logo{display:flex;align-items:center;gap:10px;text-decoration:none;color:var(--text);user-select:none;position:relative;}
    .logo-circle{width: clamp(72px, 9vw, 120px);aspect-ratio:1/1;border-radius:50%;overflow:hidden;display:flex;align-items:center;justify-content:center;background: rgba(255,255,255,0.03);border: 10px solid rgba(255,255,255,0.06);box-shadow: 0 10px 24px rgba(0,0,0,0.4);transform: translateZ(0);flex-shrink:0;}
    .logo-circle img{width:100%;height:100%;object-fit:cover;object-position:center center;display:block;transform: translateZ(0);}

    nav ul{list-style:none;margin:0;padding:0;display:flex;gap:10px;align-items:center;}
    nav ul li a{
      font-weight:700;
      font-size:14px;
      position:relative;
      padding:8px 12px;
      color:var(--muted);
      text-decoration:none;
      border-radius:8px;
      transition:all .18s var(--ease);
      display:flex;
      align-items:center;
      gap: 8px;
      border: none;
      box-shadow: none;
      outline: none;
      background: transparent;
    }
    nav ul li a:hover{color:var(--text);transform: translateY(-3px) scale(1.02);background: var(--glass);}
    
    /* PERFORMANCE: Removed heavy neon glow effect (::before pseudo-element) */
    header nav ul li a::after,
    .logo::after{
      content: "";
      position: absolute;
      inset: -4px;
      border-radius: 12px;
      border: 1px solid transparent; /* Simplified border */
      opacity: 0.75;
      z-index: -1;
      pointer-events: none;
      transition: border-color .18s ease;
    }
    header nav ul li a:hover::after,
    .logo:hover::after{
      border-color: rgba(57,190,60,0.38);
    }

    .wrapper.style1{padding-top:24px;}
    .inner{max-width:1100px;margin:0 auto;padding:20px;position:relative;z-index:3;}

    .list-container{list-style:none;padding:0;display:flex;flex-wrap:wrap;gap:1rem;justify-content:center;align-items:flex-start;margin-top:6px;}
    /* PERFORMANCE: Optimized list item styles, removed backdrop-filter, simplified shadows and transforms. */
    .list-item{width:150px;cursor:pointer;text-align:center;background:rgba(18, 20, 28, 0.5);border-radius:var(--card-radius);padding:10px;transition:transform .25s var(--ease),box-shadow .25s var(--ease); border:1px solid rgba(255,255,255,0.06); box-shadow:0 8px 24px rgba(6,8,16,0.5);position:relative;will-change:transform, opacity;}

    .list-item::after{content:'';position:absolute;left:8px;right:8px;bottom:8px;height:4px;border-radius:4px;background:linear-gradient(90deg, rgba(123,97,255,0.25), rgba(57,255,20,0.18), rgba(255,107,107,0.12));opacity:0;transform:translateY(6px);transition:opacity .25s var(--ease),transform .25s var(--ease);pointer-events:none;}
    .list-item:hover::after{opacity:1;transform:translateY(0);}
    .list-item:hover{transform: translateY(-6px) scale(1.02); box-shadow:0 16px 32px rgba(6,8,16,0.6);}
    .list-item img{width:100%;border-radius:6px;display:block;transition:transform .4s var(--ease);box-shadow:0 8px 20px rgba(0,0,0,0.4);will-change:transform;background:rgba(0,0,0,0.1);}
    .list-item:hover img{transform:scale(1.04);}

    .list-item .title{display:block;margin-top:0.45rem;color:var(--text);font-weight:700;font-size:14px;text-shadow:0 1px 0 rgba(0,0,0,0.45);}

    .modal-backdrop{position:fixed;inset:0;background:linear-gradient(180deg, rgba(2,3,8,0.6), rgba(0,0,0,0.75));display:flex;align-items:center;justify-content:center;z-index:9999;}
    .modal{width:min(960px,95%);background:linear-gradient(180deg, rgba(12,12,12,0.96), rgba(6,6,8,0.98));border-radius:14px;padding:18px;color:#fff;border:1px solid rgba(255,255,255,0.035);box-shadow:0 25px 50px rgba(2,6,18,0.7);}

    .controls{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;gap:8px;}
    .btn{background:linear-gradient(90deg, var(--accent-1), var(--accent-3));color:#fff;padding:8px 12px;border-radius:8px;border:0;cursor:pointer;font-weight:700;}
    .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);box-shadow:none;}

    .password-row{display:flex;gap:8px;margin-top:8px;}
    .password-row input{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:rgba(255,255,255,0.02);color:var(--text);outline:none;transition:box-shadow .15s;}
    .password-row input:focus{box-shadow:0 0 0 2px var(--accent-1);}
    .muted{color:var(--muted);font-size:13px;}

    @media (max-width:720px){ .list-item{width:calc(50% - 12px);} .modal iframe{height:320px;} }

    .list-item{opacity:0;transform-origin:center;animation:floatIn .5s forwards;}
    @keyframes floatIn{from{opacity:0;transform:translateY(12px) scale(.995);}to{opacity:1;transform:translateY(0) scale(1);} }

    .ripple{position:relative;overflow:hidden;}
    .ripple .drop{position:absolute;border-radius:50%;transform:scale(0);background:rgba(255,255,255,0.10);animation:rip .6s ease-out;pointer-events:none;}
    @keyframes rip{to{transform:scale(6);opacity:0;}}

    header nav ul li a.touch-active, .logo.touch-active{transform:scale(0.985);transition:transform .08s linear;box-shadow:0 6px 18px rgba(0,0,0,0.6);}
    header nav ul li a.pulse, .logo.pulse{animation:btnPulse .5s ease-out;}
    @keyframes btnPulse{0%{box-shadow:0 0 0 rgba(57,255,20,0.28);}50%{box-shadow:0 0 30px rgba(57,255,20,0.22);}100%{box-shadow:0 0 0 rgba(57,255,20,0);} }

    /* Player CSS */
    .vidu-player-host { position: relative; width:100%; overflow:hidden; border-radius:8px; background:#000; }
    .vidu-mount { width:100%; height:520px; background:#000; display:block; }
    .vidu-mount iframe{ width:100%; height:100%; display:block; border:0; pointer-events:none; }

    .vidu-loading { position:absolute; inset:0; z-index:9995; display:flex; align-items:center; justify-content:center; background-image: url('assets/images/background.png'); background-repeat: no-repeat; background-position: center; background-size: cover; transition: opacity .28s ease; }
    .vidu-loading.hidden { opacity:0; pointer-events:none; }

    .vidu-controls-bg { position:absolute; left:0; right:0; bottom:0; height:64px; background:linear-gradient(180deg, transparent, rgba(0,0,0,0.75)); pointer-events:none; z-index:9996; transition:opacity .22s ease; will-change:opacity; }
    .vidu-controls-bg.hidden { opacity:0; }

    .vidu-overlay { position:absolute; left:12px; right:12px; bottom:12px; z-index:9999; display:flex; gap:12px; align-items:center; padding:8px 12px; border-radius:10px; box-sizing:border-box; transition:opacity .18s ease,transform .18s ease; flex-wrap:wrap; justify-content:flex-start; will-change: opacity, transform; }
    .vidu-overlay.hidden { opacity:0; transform: translateY(6px); pointer-events:none; }
    .vidu-overlay .inner-bg{ position:absolute; inset:0; border-radius:10px; pointer-events:none; background:rgba(20, 22, 28, 0.6); z-index:-1; border: 1px solid rgba(255,255,255,0.05);}

    .vidu-btn { background: rgba(255,255,255,0.08); color:#fff; padding:8px; border-radius:22px; cursor:pointer; user-select:none; border:1px solid rgba(255,255,255,0.04); display:flex; align-items:center; justify-content:center; width:46px; height:46px; transition:transform .12s ease; }
    .vidu-btn:active{ transform: scale(.96); }

    .vidu-range { flex:1; -webkit-appearance:none; height:8px; border-radius:8px; background: rgba(255,255,255,0.1); min-width:120px; }
    .vidu-range::-webkit-slider-thumb{ -webkit-appearance:none; width:16px; height:16px; border-radius:50%; background:var(--accent-2); box-shadow:0 2px 8px rgba(0,0,0,0.5); border:2px solid rgba(0,0,0,0.18); margin-top:-4px; }
    .vidu-range::-moz-range-thumb{ width:16px; height:16px; border-radius:50%; background:var(--accent-2); border:2px solid rgba(0,0,0,0.18); }

    .vidu-time { min-width:90px; font-size:14px; font-weight:800; color:#cbd5ff; text-align:center; letter-spacing:1px; }

    .vidu-close-btn { position:absolute; top:10px; right:10px; z-index:10002; width:36px; height:36px; padding:6px; border-radius:8px; background:rgba(0,0,0,0.5); border:1px solid rgba(255,255,255,0.06); color:#fff; display:flex; align-items:center; justify-content:center; font-weight:800; cursor:pointer; box-shadow:0 8px 20px rgba(0,0,0,0.5); transition: opacity .18s ease, transform .18s ease; will-change: opacity, transform; }
    .vidu-close-btn.hidden { opacity:0; transform: translateY(-6px); pointer-events:none; }

    #close-player { display:none !important; }

    /* Other player styles remain largely unchanged as they are functional */
    .vidu-player-host:-webkit-full-screen .vidu-mount, .vidu-player-host:fullscreen .vidu-mount { height:100vh !important; width:100% !important; }
    .vidu-player-host:-webkit-full-screen .vidu-mount iframe, .vidu-player-host:fullscreen .vidu-mount iframe { height:100vh !important; width:100% !important; max-height:none !important; }
    .vidu-player-host:-webkit-full-screen .vidu-overlay, .vidu-player-host:fullscreen .vidu-overlay { left:0 !important; right:0 !important; bottom:18px !important; width:100% !important; justify-content:center !important; padding:18px !important; }
    @media (max-width:720px){ .vidu-mount{ height:320px; } .vidu-overlay{ left:8px; right:8px; bottom:8px; gap:8px; padding:8px; } .vidu-controls-bg { height:56px; } .vidu-time { min-width:76px; font-size:12px; } .vidu-range { min-width:100px; } }
    @media (max-width:540px){ .vidu-overlay{ flex-wrap:wrap; justify-content:flex-start; } .vidu-time{ min-width:68px; font-size:12px; } .vidu-range{ min-width:86px; } .vidu-btn{ width:38px; height:38px; } .vidu-close-btn{ top:8px; right:8px; } }
    @media (max-width:420px){ .vidu-time{ min-width:60px; font-size:12px; } .vidu-range{ min-width:72px; } .vidu-btn{ width:36px; height:36px; } }

    .vidu-vol-feedback{ position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); z-index:10003; padding:12px 18px; border-radius:12px; background:rgba(0,0,0,0.7); border:1px solid rgba(255,255,255,0.06); font-weight:800; font-size:18px; color:var(--text); box-shadow:0 10px 25px rgba(0,0,0,0.5); pointer-events:none; opacity:0; transition:opacity .28s ease; display:none; min-width:72px; text-align:center; }
    
    .header-icon-btn { background: transparent; border: none; color: var(--muted); cursor: pointer; padding: 8px; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: all .18s var(--ease); position: relative; width: 38px; height: 38px; }
    .header-icon-btn:hover { color: var(--text); background: var(--glass); transform: scale(1.1); }
    .header-icon-btn svg { width: 22px; height: 22px; fill: currentColor; }

    /* Notification Panel Styles */
    .notification-panel { position: fixed; top: 80px; right: 22px; width: 340px; max-width: 90vw; background: rgba(20, 22, 28, 0.95); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: var(--card-radius); box-shadow: 0 16px 50px rgba(2, 4, 12, 0.6); z-index: 10000; color: var(--text); opacity: 0; transform: translateY(-10px) scale(0.98); transition: opacity .25s var(--ease), transform .25s var(--ease); pointer-events: none; will-change: opacity, transform; }
    .notification-panel.show { opacity: 1; transform: translateY(0) scale(1); pointer-events: auto; }
    .notification-header { display: flex; justify-content: space-between; align-items: center; padding: 12px 18px; border-bottom: 1px solid rgba(255, 255, 255, 0.07); }
    .notification-header h3 { margin: 0; font-size: 16px; font-weight: 700; }
    .notification-close-btn { background: none; border: none; color: var(--muted); font-size: 26px; line-height: 1; cursor: pointer; padding: 0 4px; transition: color .18s ease, transform .18s ease; }
    .notification-close-btn:hover { color: var(--text); transform: scale(1.1); }
    .notification-content { padding: 18px; font-size: 14px; max-height: 400px; overflow-y: auto; }
    .notification-content p { margin: 0; line-height: 1.6; }

    /* Loading Popup Styles */
    .loading-popup-overlay { position: fixed; inset: 0; background: rgba(4, 6, 12, 0.7); z-index: 20000; display: flex; align-items: center; justify-content: center; opacity: 0; pointer-events: none; transition: opacity 0.3s var(--ease); will-change: opacity; }
    .loading-popup-overlay.show { opacity: 1; pointer-events: auto; }
    .loading-popup-content { background: linear-gradient(180deg, #1c1c20, #121214); padding: 28px 35px; border-radius: var(--card-radius); border: 1px solid rgba(255, 255, 255, 0.08); box-shadow: 0 12px 40px rgba(0,0,0,0.5); text-align: center; max-width: 400px; width: 90%; color: var(--text); }
    .loading-popup-content p { margin: 0 0 18px 0; font-size: 16px; font-weight: 600; line-height: 1.6; }
    .loading-bar-container { width: 100%; height: 8px; background: var(--glass-strong); border-radius: 8px; overflow: hidden; }
    .loading-bar-fill { width: 0%; height: 100%; background: linear-gradient(90deg, var(--accent-1), var(--accent-2)); border-radius: 8px; }

    /* === Fullscreen Playlist Popup Styles (Optimized) === */
    .fs-playlist-overlay { position: fixed; inset: 0; background: rgba(8, 9, 14, 0.9); z-index: 15000; display: none; flex-direction: column; color: var(--text); opacity: 0; transform: scale(1.02); transition: opacity 0.3s var(--ease), transform 0.3s var(--ease); will-change: opacity, transform; }
    .fs-playlist-overlay.show { display: flex; opacity: 1; transform: scale(1); }
    .fs-playlist-header { display: flex; align-items: center; padding: 18px 24px; background: rgba(255, 255, 255, 0.03); border-bottom: 1px solid rgba(255, 255, 255, 0.08); flex-shrink: 0; }
    .fs-playlist-header h3 { margin: 0; font-size: 18px; font-weight: 800; }
    .fs-playlist-count { margin-left: 16px; font-size: 14px; font-weight: 600; color: var(--muted); background: var(--glass-strong); padding: 4px 10px; border-radius: 16px; }
    .fs-playlist-close-btn { margin-left: auto; background: none; border: none; color: var(--muted); font-size: 32px; line-height: 1; cursor: pointer; transition: color .2s ease, transform .2s ease; }
    .fs-playlist-close-btn:hover { color: var(--text); transform: scale(1.1) rotate(90deg); }
    .fs-playlist-content { flex: 1; overflow-y: auto; padding: 24px; display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; align-content: start; }
    .fs-playlist-item { background: rgba(255,255,255,0.02); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: var(--card-radius); padding: 12px; cursor: pointer; transition: transform 0.25s var(--ease), box-shadow 0.25s var(--ease), background 0.25s var(--ease); will-change: transform; }
    .fs-playlist-item:hover { transform: translateY(-8px); box-shadow: 0 12px 30px rgba(0,0,0,0.4); background: var(--glass-strong); }
    .fs-playlist-item img { width: 100%; aspect-ratio: 16/9; object-fit: cover; border-radius: 6px; margin-bottom: 12px; box-shadow: 0 8px 20px rgba(0,0,0,0.3); }
    .fs-playlist-item .title { font-weight: 700; font-size: 14px; line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; }
    .fs-playlist-loader { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(8, 9, 14, 0.7); }
    .fs-playlist-loader .spinner { width: 50px; height: 50px; border: 4px solid var(--glass-strong); border-top-color: var(--accent-2); border-radius: 50%; animation: spin 1s linear infinite; }
    .fs-playlist-loader p { margin-top: 16px; font-weight: 600; color: var(--muted); }
    @keyframes spin { to { transform: rotate(360deg); } }

  </style>
</head>
<body class="landing is-preload">

 <div id="wrapper">
  <header id="header">
    <a href="index.html" class="logo" aria-label="VIDU home" title="VIDU home">
      <div class="logo-circle" aria-hidden="true">
        <img src="https://i.pinimg.com/736x/4d/fa/7b/4dfa7b57656b556f257b4a2e4f8fc8fa.jpg" alt="VIDU Logo" />
      </div>
    </a>
    <div class="header-right-controls">
        <button id="download-btn-header" class="header-icon-btn" data-link="https://vidu2006.netlify.app/assets/tools/coming%20soon" aria-label="Download" title="Download">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"/></svg>
        </button>
        <nav>
          <ul>
            <li><a href="videos.html">🔒Private</a></li>
            <li>
              <a href="Tools.html" id="nav-tools" title="Tools" aria-label="Tools">
                🤖Tools
              </a>
            </li>
            <li><a href="about.html">ℹ️About</a></li>
          </ul>
        </nav>
        <button id="notification-btn" class="header-icon-btn" aria-label="Notifications" title="Notifications">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>
        </button>
    </div>
  </header>

  <section id="home" class="wrapper style1 fade-up">
    <div class="inner">
      <h2></h2>
      <ul id="playlist-list" class="list-container"></ul>
      <div id="playlist-videos" style="margin-top:2rem; display:none;"></div>
    </div>
  </section>

  <footer id="footer">
    <p>&copy; VIDU. 2025 All rights reserved.</p>
  </footer>
 </div>

 <div id="modal-root" style="display:none;"></div>

 <div id="notification-panel" class="notification-panel" role="dialog" aria-labelledby="notification-title" aria-hidden="true">
    <div class="notification-header">
        <h3 id="notification-title">Notifications</h3>
        <button id="notification-close-btn" class="notification-close-btn" aria-label="Close notifications">&times;</button>
    </div>
    <div class="notification-content">
        <p>Welcome to <strong>VIDU</strong>! I'm constantly working on new features. Stay tuned for exciting updates coming soon! 🚀 Maybe a software 🤔</p>
        <p style="margin-top:12px; font-size:12px; color: var(--muted);"><em>September 16, 2025</em></p>
    </div>
 </div>
 
 <div id="loading-popup-overlay" class="loading-popup-overlay">
  <div class="loading-popup-content">
    <p id="loading-popup-message">Preparing your content, please wait...</p>
    <div class="loading-bar-container">
      <div id="loading-bar-fill" class="loading-bar-fill"></div>
    </div>
  </div>
</div>

<div id="fullscreen-playlist-overlay" class="fs-playlist-overlay">
  <div class="fs-playlist-header">
    <h3 id="fs-playlist-title"></h3>
    <span id="fs-playlist-count" class="fs-playlist-count">0 Videos</span>
    <button id="fs-playlist-close-btn" class="fs-playlist-close-btn" aria-label="Close Playlist">&times;</button>
  </div>
  <div id="fs-playlist-content" class="fs-playlist-content"></div>
  <div id="fs-playlist-loader" class="fs-playlist-loader" style="display: none;">
    <div class="spinner"></div>
    <p>Loading playlist...</p>
  </div>
</div>

<div id="player-loading-overlay" class="loading-popup-overlay">
  <div class="loading-popup-content">
    <p>Loading VIDU Player</p>
    <div class="loading-bar-container">
      <div id="player-loading-bar-fill" class="loading-bar-fill"></div>
    </div>
  </div>
</div>

 <script>
// Vidu Player Core - Unchanged from previous optimization
(function(){if(window.__viduPlayerLoaded)return;window.__viduPlayerLoaded=!0;const e={player:null,animationFrameId:null,keyHandler:null,mo:null,host:null,mount:null,fsResizeHandler:null,fsListener:null,docClickHandler:null,inactivityTimer:null,lastActivity:Date.now(),desiredPlaying:null,lastVolume:100,_menuOpenTs:0};function t(){if(window.YT&&window.YT.Player)return Promise.resolve();if(window._vidu_loading_yt)return new Promise((e,t)=>{const n=setInterval(()=>{window.YT&&window.YT.Player&&(clearInterval(n),e())},80);setTimeout(()=>{clearInterval(n),t(new Error("YT load timeout"))},2e4)});window._vidu_loading_yt=!0;return new Promise((e,t)=>{const n=document.createElement("script");n.src="https://www.youtube.com/iframe_api",n.async=!0,n.onerror=()=>t(new Error("YT API failed to load")),document.head.appendChild(n),window.onYouTubeIframeAPIReady=function(){e()},setTimeout(()=>{window.YT&&window.YT.Player&&e()},1200),setTimeout(()=>{window.YT&&window.YT.Player||t(new Error("YT API timed out"))},2e4)})}try{window.loadYTApi=t}catch(e){}function n(e){return e=Math.max(0,Math.floor(e||0)),e<10?"0"+e:String(e)}function o(e){e=Math.max(0,Math.floor(e||0));const t=Math.floor(e/3600),o=Math.floor(e%3600/60),r=e%60;return n(t)+" : "+n(o)+" : "+n(r)}function r(){return`<svg viewbox="0 0 24 24" width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 4.5v15l12-7.5L6 4.5z" fill="#fff"/></svg>`}function a(){return`<svg viewbox="0 0 24 24" width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="4" width="4" height="16" rx="1.2" fill="#fff"/><rect x="15" y="4" width="4" height="16" rx="1.2" fill="#fff"/></svg>`}function i(){return`<svg viewbox="0 0 24 24" width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M12 15.5A3.5 3.5 0 1 0 12 8.5a3.5 3.5 0 0 0 0 7zm7.4-3.5c0-.4-.03-.78-.09-1.15l1.86-1.44a.5.5 0 0 0 .12-.65l-1.76-3.05a.5.5 0 0 0-.6-.22l-2.2.88a7.72 7.72 0 0 0-1.9-1.1l-.33-2.33A.5.5 0 0 0 13.9 2h-3.8a.5.5 0 0 0-.5.42l-.33 2.33c-.69.25-1.35.6-1.95 1.02l-2.2-.88a.5.5 0 0 0-.6.22L2.7 6.96a.5.5 0 0 0 .12.65l1.86 1.44c-.06.37-.09.75-.09 1.15s.03.78.09 1.15L2.82 14.95a.5.5 0 0 0-.12.65l1.76 3.05c.14.24.4.34.64.28l2.2-.88c.6.42 1.26.77 1.95 1.02l.33 2.33c.03.25.25.42.5.42h3.8c.25 0 .47-.17.5-.42l.33-2.33c.69-.25 1.35-.6 1.95-1.02l2.2.88c.24.09.5-.04.64-.28l1.76-3.05a.5.5 0 0 0-.12-.65l-1.86-1.44c.06-.37.09-.75.09-1.15z" fill="#fff"/></svg>`}function l(e){try{const t=e.querySelector("iframe");t&&(t.style.pointerEvents="none",t.setAttribute("allow","autoplay; encrypted-media; fullscreen"),t.setAttribute("allowfullscreen",""),t.setAttribute("tabindex","-1"))}catch(e){console.warn("disableIframeClicks",e)}}window.showViduPlayer=function(n){return"function"!=typeof window.loadYTApi&&(window.loadYTApi=t),function(t){const n=function(){let e=document.getElementById("player-wrap");if(!e){const t=document.getElementById("modal-root")||document.body,n=t&&t.querySelector&&t.querySelector(".modal")?t.querySelector(".modal"):t;e=document.createElement("div"),e.id="player-wrap",e.style.minWidth="320px";try{n?n.appendChild(e):document.body.appendChild(e)}catch(t){try{document.body.appendChild(e)}catch(e){}}}const t=e.querySelector(".vidu-player-host");t&&t.remove();const n=document.createElement("div");n.className="vidu-player-host";const l=document.createElement("div");l.className="vidu-mount",l.id="vidu_mount_"+Math.floor(1e6*Math.random()),l.style.height="520px",l.style.background="#000",n.appendChild(l);const s=document.createElement("div");s.className="vidu-loading",s.id="vidu_loading",n.appendChild(s);const d=document.createElement("div");d.className="vidu-controls-bg",n.appendChild(d);const c=document.createElement("div");c.className="vidu-overlay",c.innerHTML=`\n      <div class="inner-bg" aria-hidden="true"></div>\n      <button class="vidu-btn" id="vidu_playbtn">${r()}</button>\n      <div class="vidu-time" id="vidu_cur">`+o(0)+`</div>\n      <input id="vidu_seek" class="vidu-range" type="range" min="0" max="100" step="0.1" value="0" />\n      <div class="vidu-time" id="vidu_dur">`+o(0)+`</div>\n\n      <button class="vidu-btn" id="vidu_playbackbtn" title="Playback speed" aria-label="Playback speed">`+i()+`</button>\n      <button class="vidu-btn" id="vidu_fullbtn">⤢</button>\n    `,n.appendChild(c);const u=document.createElement("div");u.className="vidu-quality-menu",u.id="vidu_quality_menu",n.appendChild(u);const m=document.createElement("button");m.className="vidu-close-btn",m.id="vidu_closebtn",m.title="Close",m.type="button",m.innerHTML="✕",m.addEventListener("click",()=>{try{"function"==typeof window.closeModal?window.closeModal():(document.getElementById("modal-root")?.style.display="none",window.destroyViduPlayer&&window.destroyViduPlayer())}catch(e){console.warn("closeBtn error",e)}}),n.appendChild(m);const p=document.createElement("div");return p.id="vidu_vol_feedback",p.className="vidu-vol-feedback",p.style.display="none",n.appendChild(p),e.appendChild(n),{host:n,mount:l,overlay:c,ctrlBg:d,closeBtn:m,qmenu:u,loadingDiv:s}}(),{host:l,mount:s,overlay:d,ctrlBg:c,closeBtn:u,qmenu:m,loadingDiv:p}=n;e.host=l,e.mount=s;const d=d.querySelector("#vidu_playbtn"),c=d.querySelector("#vidu_cur"),u=d.querySelector("#vidu_dur"),m=d.querySelector("#vidu_seek"),p=d.querySelector("#vidu_fullbtn"),f=d.querySelector("#vidu_playbackbtn"),h=l.querySelector("#vidu_vol_feedback");function y(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||null}const b={stored:!1,host:{},mount:{},iframe:{}};function v(){d.classList.add("hidden"),c.classList.add("hidden"),u&&u.classList.add("hidden"),m&&m.classList.remove("open")}function g(){try{p&&p.classList.remove("hidden")}catch(e){}}function w(){try{p&&(p.classList.add("hidden"),setTimeout(()=>{try{p.style.display="none"}catch(e){}},320))}catch(e){}}let k=!1;document.addEventListener("click",function(t){const n=Date.now();n-e._menuOpenTs<250||(k&&(m&&!m.contains(t.target)&&(m.classList.remove("open"),k=!1)),S&&(!x||x.contains(t.target)||f&&f.contains(t.target)||C()))},{passive:!0}),e.keyHandler=function(t){const n=document.activeElement,i=n&&"vidu_seek"===n.id;if(n&&("INPUT"===n.tagName||"TEXTAREA"===n.tagName||n.isContentEditable)&&!i)return;const l=document.getElementById("modal-root");if(!l||"none"===l.style.display)return;if("Space"===t.code||" "===t.key){t.preventDefault();if(e.player){let t=-1;try{t=e.player.getPlayerState?e.player.getPlayerState():-1}catch(e){}const n=1!==t;e.desiredPlaying=n;try{d.innerHTML=n?a():r()}catch(e){}try{n?e.player.playVideo&&e.player.playVideo():e.player.pauseVideo&&e.player.pauseVideo()}catch(t){console.warn("space toggle err",t)}L()}return}if("KeyF"===t.code||"f"===t.key||"F"===t.key)return t.preventDefault(),void function(){const e=y();if(e===l){const e=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;e&&e.call(document)}else{const e=l.requestFullscreen||l.webkitRequestFullscreen||l.mozRequestFullScreen||l.msRequestFullscreen;e&&e.call(l)}}();if("ArrowRight"===t.key||"ArrowRight"===t.code||"Right"===t.key){t.preventDefault();try{if(e.player&&e.player.getCurrentTime){const t=Number(e.player.getCurrentTime()||0),n=e.player.getDuration?Number(e.player.getDuration()||0):NaN,o=Number.isFinite(n)?Math.min(n,t+10):t+10;e.player.seekTo&&e.player.seekTo(o,!0),L()}}catch(t){console.warn("seek forward err",t)}return}if("ArrowLeft"===t.key||"ArrowLeft"===t.code||"Left"===t.key){t.preventDefault();try{if(e.player&&e.player.getCurrentTime){const t=Number(e.player.getCurrentTime()||0)-10;e.player.seekTo&&e.player.seekTo(Math.max(0,t),!0),L()}}catch(t){console.warn("seek back err",t)}return}if("ArrowUp"===t.key||"ArrowUp"===t.code||"Up"===t.key){t.preventDefault();try{if(e.player&&e.player.getVolume&&e.player.setVolume){let t=Number(e.player.getVolume()||0);t=Math.min(100,Math.round(t+5)),e.player.setVolume(t),t>0&&e.player.unMute&&e.player.unMute(),h&&function(e){try{if(!h)return;const t=Math.max(0,Math.min(100,Math.round(e||0)));h.textContent=t+"%",h.style.display="block",h.style.opacity="1",l._volFeedbackTimeout&&clearTimeout(l._volFeedbackTimeout),l._volFeedbackTimeout=setTimeout(()=>{try{h.style.opacity="0",setTimeout(()=>{try{h.style.display="none"}catch(e){}},320)}catch(e){}},3e3)}catch(e){console.warn("showVolumeFeedback err",e)}}(t)}}catch(t){console.warn("volume up err",t)}return}if("ArrowDown"===t.key||"ArrowDown"===t.code||"Down"===t.key){t.preventDefault();try{if(e.player&&e.player.getVolume&&e.player.setVolume){let t=Number(e.player.getVolume()||0);t=Math.max(0,Math.round(t-5)),e.player.setVolume(t),0===t&&e.player.mute&&e.player.mute(),h&&function(e){try{if(!h)return;const t=Math.max(0,Math.min(100,Math.round(e||0)));h.textContent=t+"%",h.style.display="block",h.style.opacity="1",l._volFeedbackTimeout&&clearTimeout(l._volFeedbackTimeout),l._volFeedbackTimeout=setTimeout(()=>{try{h.style.opacity="0",setTimeout(()=>{try{h.style.display="none"}catch(e){}},320)}catch(e){}},3e3)}catch(e){console.warn("showVolumeFeedback err",e)}}(t)}}catch(t){console.warn("volume down err",t)}return}},document.addEventListener("keydown",e.keyHandler),m.addEventListener("pointerdown",()=>m._drag=!0,{passive:!0}),m.addEventListener("pointerup",()=>{m._drag=!1;if(!e.player)return;const t=e.player.getDuration?e.player.getDuration():0;t&&e.player.seekTo(t*(parseFloat(m.value)/100),!0)},{passive:!0}),m.addEventListener("input",()=>{if(m._drag&&e.player){const t=e.player.getDuration?e.player.getDuration():0;t&&(c.textContent=o(Math.floor(t*(parseFloat(m.value)/100)))),E(m)}},{passive:!0});function E(e){try{const t=Math.max(0,Math.min(100,parseFloat(e.value)||0));e.style.background=`linear-gradient(90deg, var(--accent-2) ${t}%, rgba(255,255,255,0.06) ${t}%)`}catch(e){}}E(m),d.addEventListener("click",()=>{if(!e.player)return;let t=-1;try{t=e.player.getPlayerState?e.player.getPlayerState():-1}catch(e){}const n=1!==t;e.desiredPlaying=n,d.innerHTML=n?a():r();try{n?e.player.playVideo&&e.player.playVideo():e.player.pauseVideo&&e.player.pauseVideo()}catch(t){console.warn("play/pause toggle err",t)}L()});const _=function(){const t=y(),n=!!(t&&(t===l||l.contains(t)||(t.contains&&t.contains(l))));if(n){if(!b.stored){b.host.position=l.style.position||"",b.host.top=l.style.top||"",b.host.left=l.style.left||"",b.host.width=l.style.width||"",b.host.height=l.style.height||"",b.host.zIndex=l.style.zIndex||"",b.host.borderRadius=l.style.borderRadius||"",b.mount.height=s.style.height||"",b.mount.width=s.style.width||"",b.mount.maxHeight=s.style.maxHeight||"",b.mount.maxWidth=s.style.maxWidth||"";const e=l.querySelector("iframe");e?(b.iframe.height=e.style.height||"",b.iframe.width=e.style.width||"",b.iframe.pointerEvents=e.style.pointerEvents||"",b.iframe.maxHeight=e.style.maxHeight||"",b.iframe.maxWidth=e.style.maxWidth||""):b.iframe={},b.stored=!0}try{l.style.position="fixed",l.style.top="0",l.style.left="0",l.style.width="100vw",l.style.height="100vh",l.style.zIndex="2147483647",l.style.borderRadius="0"}catch(e){}try{s.style.width="100%",s.style.height="100%",s.style.maxHeight="none",s.style.maxWidth="none"}catch(e){}try{const e=l.querySelector("iframe");e&&(e.style.width="100%",e.style.height="100%",e.style.maxHeight="none",e.style.maxWidth="none",e.style.pointerEvents="auto")}catch(e){}d.classList.remove("hidden"),c.classList.remove("hidden"),u&&u.classList.remove("hidden"),e.fsResizeHandler||(e.fsResizeHandler=()=>{const t=y();if(t&&(t===l||l.contains(t)||(t.contains&&t.contains(l))))try{l.style.width=window.innerWidth+"px",l.style.height=window.innerHeight+"px",s.style.height=window.innerHeight+"px";const e=l.querySelector("iframe");e&&(e.style.height=window.innerHeight+"px")}catch(e){}},window.addEventListener("resize",e.fsResizeHandler))}else{if(b.stored){try{l.style.position=b.host.position,l.style.top=b.host.top,l.style.left=b.host.left,l.style.width=b.host.width,l.style.height=b.host.height,l.style.zIndex=b.host.zIndex,l.style.borderRadius=b.host.borderRadius}catch(e){}try{s.style.height=b.mount.height,s.style.width=b.mount.width,s.style.maxHeight=b.mount.maxHeight,s.style.maxWidth=b.mount.maxWidth}catch(e){}try{const e=l.querySelector("iframe");e&&(e.style.height=b.iframe.height,e.style.width=b.iframe.width,e.style.pointerEvents=b.iframe.pointerEvents,e.style.maxHeight=b.iframe.maxHeight,e.style.maxWidth=b.iframe.maxWidth)}catch(e){}b.stored=!1}else try{s.style.height="520px",s.style.width="100%";const e=l.querySelector("iframe");e&&(e.style.pointerEvents="none")}catch(e){}e.fsResizeHandler&&(window.removeEventListener("resize",e.fsResizeHandler),e.fsResizeHandler=null),d.classList.contains("hidden")?(c.classList.add("hidden"),u&&u.classList.add("hidden")): (c.classList.remove("hidden"),u&&u.classList.remove("hidden"))}};e.fsListener=_,document.addEventListener("fullscreenchange",e.fsListener),document.addEventListener("webkitfullscreenchange",e.fsListener),document.addEventListener("mozfullscreenchange",e.fsListener),document.addEventListener("MSFullscreenChange",e.fsListener);function L(){e.lastActivity=Date.now(),d.classList.remove("hidden"),c.classList.remove("hidden"),u&&u.classList.remove("hidden"),e.inactivityTimer&&(clearTimeout(e.inactivityTimer),e.inactivityTimer=null),e.inactivityTimer=setTimeout(()=>{try{const t=e.player&&e.player.getPlayerState?e.player.getPlayerState():-1;1===t||3===t||-1===t||0===t||5===t?(v(),m&&m.classList.remove("open")):g()}catch(e){}},5e3)}!function(){try{["mousemove","pointermove","touchstart","touchmove","keydown","mousedown"].forEach(t=>{l.addEventListener(t,L,{passive:!0}),document.addEventListener(t,L,{passive:!0})})}catch(e){}}();let x=null,S=!1,q=null;function C(){if(!x)return;try{x.remove()}catch(e){}x=null,S=!1,q&&(document.removeEventListener("click",q),q=null)}new MutationObserver(()=>{S&&(!document.body.contains(f)||!document.body.contains(l))&&C()}).observe(document.body,{childList:!0,subtree:!0});const P=()=>{if(!e.player||!document.body.contains(e.host))return void window.destroyViduPlayer();try{const t=e.player.getDuration?e.player.getDuration():0,n=e.player.getCurrentTime?e.player.getCurrentTime():0;c.textContent=o(Math.floor(n)),u.textContent=t&&isFinite(t)?o(Math.floor(t)):"00 : 00 : 00",m._drag||!t||!isFinite(t)||(m.value=n/Math.max(1,t)*100,E(m));const i=e.player.getPlayerState?e.player.getPlayerState():-1;if(null!==e.desiredPlaying)try{e.desiredPlaying&&1!==i?e.player.playVideo():e.desiredPlaying||1!==i||e.player.pauseVideo()}catch(e){}const l=1===i?a():r();Date.now()-e.lastActivity>300?d.innerHTML=l:setTimeout(()=>{try{d.innerHTML=1===(e.player.getPlayerState?e.player.getPlayerState():-1)?a():r()}catch(e){}},600)}catch(e){}e.animationFrameId=requestAnimationFrame(P)};return t().then(()=>new Promise((n,o)=>{e.player&&e.player.destroy&&(e.player.destroy(),e.player=null);try{e.player=new YT.Player(s.id,{videoId:t,width:"100%",height:"100%",playerVars:{controls:0,disablekb:1,rel:0,modestbranding:1,playsinline:1,iv_load_policy:3,origin:location.origin},events:{onReady:function(t){l(l),g();try{const n=Math.max(0,Math.min(100,e.lastVolume||100));t.target.setVolume(n),0===n?t.target.mute():n>0&&t.target.unMute()}catch(e){}try{const n=t.target.getAvailableQualityLevels()||[],o=t.target.getPlaybackQuality?t.target.getPlaybackQuality():"default";!function(t,n,o,r){if(!t)return;t.innerHTML="";const a=e=>{const a=document.createElement("button");a.type="button",a.dataset.qualityKey=e,a.textContent=function(e){if(!e)return"";return{small:"144p",medium:"360p",large:"480p",hd720:"720p",hd1080:"1080p",highres:"Highres",default:"Auto"}[e]||e}(e),o&&a.classList.add("active"),a.onclick=n=>{n.stopPropagation();try{r&&r.setPlaybackQuality&&r.setPlaybackQuality("default"===e?"default":e),t.querySelectorAll("button").forEach(e=>e.classList.remove("active")),a.classList.add("active"),t.classList.remove("open")}catch(e){console.warn("failed to set quality",e)}},t.appendChild(a)};a("default","Auto", "default"===o);const i=Array.isArray(n)?n.slice():[],l=["highres","hd1080","hd720","large","medium","small"];l.filter(e=>-1!==i.indexOf(e)).forEach(e=>a(e,0,o===e)),0===l.filter(e=>-1!==i.indexOf(e)).length&&l.forEach(e=>{a(e,0,o===e)})}(m,n,o,t.target),t.target.setPlaybackQuality&&t.target.setPlaybackQuality("default")}catch(e){}try{t.target.playVideo()}catch(e){}s.style.height=s.style.height||"520px",e.animationFrameId&&cancelAnimationFrame(e.animationFrameId),P(),e.mo&&e.mo.disconnect(),e.mo=new MutationObserver(()=>l(l)),e.mo.observe(l,{childList:!0,subtree:!0}),L(),n(e.player)},onStateChange:function(e){try{e&&1===e.data&&w()}catch(e){}},onError:function(e){try{const e=document.getElementById("vidu_loading");e&&(e.classList.add("hidden"),e.style.display="none")}catch(e){}console.error("YT player error",e)}}})}catch(t){o(t||new Error("YT player creation failed"))}})).catch(e=>{throw e}).then(e=>(setTimeout(()=>L(),40),e))}(n).catch(e=>{throw console.error("createPlayer failed",e),e})},window.destroyViduPlayer=function(){try{e.animationFrameId&&(cancelAnimationFrame(e.animationFrameId),e.animationFrameId=null),e.keyHandler&&(document.removeEventListener("keydown",e.keyHandler),e.keyHandler=null),e.docClickHandler&&(document.removeEventListener("click",e.docClickHandler),e.docClickHandler=null),e.player&&(e.player.destroy(),e.player=null),e.mo&&(e.mo.disconnect(),e.mo=null),e.fsResizeHandler&&(window.removeEventListener("resize",e.fsResizeHandler),e.fsResizeHandler=null),e.fsListener&&(document.removeEventListener("fullscreenchange",e.fsListener),document.removeEventListener("webkitfullscreenchange",e.fsListener),document.removeEventListener("mozfullscreenchange",e.fsListener),document.removeEventListener("MSFullscreenChange",e.fsListener),e.fsListener=null),e.inactivityTimer&&(clearTimeout(e.inactivityTimer),e.inactivityTimer=null),e.host&&["mousemove","pointermove","touchstart","touchmove","keydown","mousedown"].forEach(t=>{e.host.removeEventListener(t,L)}),e.host&&(e.host.remove(),e.host=null,e.mount=null)}catch(e){console.warn("destroyPlayer err",e)}const t=document.getElementById("player-wrap");t&&(t.innerHTML="")},window.addEventListener("beforeunload",()=>{try{window.destroyViduPlayer()}catch(e){}},{passive:!0})})();
</script>
<script>
/*************************************************************************
 * Playlist data + UI + modal + YouTube playlist fetching
 *************************************************************************/
const playlists = [ { id: 0, name: 'SUBJECTS', thumbnail: 'https://i.pinimg.com/736x/71/82/6e/71826ec9ece9f33d9034bb0acd3b8d1f.jpg', videos: [ { id: 1, name: 'ET', thumbnail: 'https://i.pinimg.com/736x/19/b2/42/19b2424009813fc558e8a785c794cbdf.jpg', videos: [ { name:'', thumbnail:'https://i.pinimg.com/736x/19/b2/42/19b2424009813fc558e8a785c794cbdf.jpg', type:'playlist', idEnc: "JiVdDwdDMwE8CD82enZEX0A4SQVvRzEEFj8eAEZGAlA/WkIGNk4VIgs9WWlhent5Pl81JjhB", passEnc: "" }, { name:'', thumbnail:'https://i.pinimg.com/736x/ea/60/d8/ea60d83595332fe2a7d11f1844072251.jpg', type:'playlist', idEnc: "JiVdDwdDMwE8CD82dFNrdjcTAhYmOlUACF0XEFRJZVkiCkIGNk4LOUBXQDRCQnRSMi4wMmYp", passEnc: "" } ] }, { id: 2, name: 'SFT', thumbnail: 'https://i.pinimg.com/736x/b8/de/57/b8de57f639bb30fd9f48cda542dd96d2.jpg', videos: [ { name:'', thumbnail:'https://i.pinimg.com/736x/2d/9d/1a/2d9d1a4affd566269879267ca70b74b8.jpg', type:'playlist', idEnc: "JiVdDwdDMwE8CD82dQkGUzsDJUIpXlMNBVBBN0ZnWAM6IUIGNk41NioUP21FXHtcGDYQIAUe", passEnc: "" }, { name:'', thumbnail:'https://i.pinimg.com/736x/42/9d/84/429d847241cfba744292224956707f45.jpg', type:'playlist', idEnc: "JiVdDwdDMwE8CD82d11cAxxZK01oQz06HiMmPkFpc3cyW0IGNk4TCT08RCt5AHdYQyU+AywV", passEnc: "" }, { name:'', thumbnail:'https://i.pinimg.com/736x/1f/24/4e/1f244ec99cab31c5d72348a736d361df.jpg', type:'playlist', idEnc: "JiVdDwdDMwE8CD82dUQDDD4zXQIlOhIgXzMlAHN+Ak9PIkIGNk5VCTgGQRdmUQQNIQwVTWpC", passEnc: "" } ] }, { id: 3, name: 'ICT', thumbnail: 'https://i.pinimg.com/736x/81/f4/0d/81f40de2906f0c61f2f17d6db61d7271.jpg', videos: [ { name:'', thumbnail:'https://i.pinimg.com/736x/81/f4/0d/81f40de2906f0c61f2f17d6db61d7271.jpg', type:'playlist', idEnc: "JiVdDwdDMwE8CD82dGVabCUtAhwaJTMuBycWPABxW0IGKkIGNk5UBEpVGytfan1tEhlVHRos", passEnc: "" } ] } ] } ];

function b64decode(s){ try{ return atob(s); }catch(e){ return s; } }
const decodeEnc = (function(){ const key = new TextEncoder().encode('vidu_secret_2025'); function xorDecode(bytes){ const out = new Uint8Array(bytes.length); for(let i=0;i<bytes.length;i++) out[i] = bytes[i] ^ key[i % key.length]; return out; } return function(encStr){ try{ if(!encStr) return ''; const raw = atob(encStr); const bytes = new Uint8Array(raw.split('').map(c=>c.charCodeAt(0))); const dec = xorDecode(bytes); return new TextDecoder().decode(dec); }catch(e){ return ''; } }; })();
function escapeHtml(s){ return (s||'').replace(/[&<>"'`]/g, ch => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;","`":"&#96;"}[ch])); }

function renderPlaylists(){
  const ul = document.getElementById('playlist-list');
  if(!ul) return;
  ul.innerHTML = '';
  if(!playlists || playlists.length === 0){ ul.innerHTML = '<li class="muted">No playlists available.</li>'; return; }
  playlists.forEach(pl=>{
    const li = document.createElement('li'); li.className='list-item ripple';
    li.innerHTML = `<img src="${escapeHtml(pl.thumbnail)}" alt="${escapeHtml(pl.name)}" /><span class="title">${escapeHtml(pl.name)}</span>`;
    li.addEventListener('click', (ev)=>{ spawnRipple(ev, li); showPlaylistVideos(pl); });
    ul.appendChild(li);
  });
  ul.style.display = 'flex';
}

function showPlaylistVideos(pl, skipPush){
  const ul = document.getElementById('playlist-list');
  const container = document.getElementById('playlist-videos');
  if(!container || !ul) return;
  if(!window.__viduGlobal) window.__viduGlobal = {};
  if(!window.__viduGlobal.playlistStack) window.__viduGlobal.playlistStack = [];
  if(!skipPush){ window.__viduGlobal.playlistStack.push(window.__viduGlobal.currentPl || null); }
  window.__viduGlobal.currentPl = pl;
  ul.style.display = 'none';
  container.style.display = 'block';
  container.innerHTML = `<h3 style="text-align:center;color:#fff;">${escapeHtml(pl.name)}</h3>`;
  const vids = document.createElement('ul'); vids.className='list-container';
  (pl.videos||[]).forEach(v=>{
    const vli = document.createElement('li'); vli.className='list-item ripple';
    const thumb = v.thumbnail || '';
    vli.innerHTML = `<img src="${escapeHtml(thumb)}" alt="${escapeHtml(v.name)}" /><span class="title">${escapeHtml(v.name)}</span>`;
    if(v && Array.isArray(v.videos)){
      vli.addEventListener('click',(ev)=>{ spawnRipple(ev, vli); showPlaylistVideos(v); });
    } else {
      vli.addEventListener('click',(ev)=>{
        spawnRipple(ev, vli);
        const expectedPassword = b64decode(v.passEnc || '');
        if (expectedPassword === '') {
          currentItem = v;
          showUnlockedItem(v);
        } else {
          openPasswordModal(v);
        }
      });
    }
    vids.appendChild(vli);
  });
  const back = document.createElement('div'); back.style.textAlign='center'; back.style.marginTop='16px';
  back.innerHTML = `<button id="back-to-playlists" class="btn secondary">Back</button>`;
  container.appendChild(vids); container.appendChild(back);
  document.getElementById('back-to-playlists').onclick = ()=>{
    const prev = (window.__viduGlobal.playlistStack && window.__viduGlobal.playlistStack.length) ? window.__viduGlobal.playlistStack.pop() : null;
    if(prev === null){ ul.style.display='flex'; container.style.display='none'; window.__viduGlobal.currentPl = null; }
    else { showPlaylistVideos(prev, true); }
  };
}

function spawnRipple(ev,target){ const rect = target.getBoundingClientRect(); const drop = document.createElement('div'); drop.className = 'drop'; drop.style.left = (ev.clientX - rect.left) + 'px'; drop.style.top = (ev.clientY - rect.top) + 'px'; target.appendChild(drop); setTimeout(()=> drop.remove(),700); }

let currentItem = null;
let currentPlaylistCache = {};

function createModal(){
  const root = document.getElementById('modal-root');
  root.innerHTML = `<div class="modal-backdrop" id="modal-backdrop"><div class="modal" role="dialog" aria-modal="true"><div class="controls"><div><strong id="modal-title">Locked</strong><div class="muted" id="modal-subtitle" style="color:#bbb;font-size:12px;"></div></div><div><button id="modal-close" class="btn secondary">Close</button></div></div><div id="modal-body"><div id="password-block"><div style="color:#bbb;margin-bottom:8px;">This item is password-protected. Enter password to unlock.</div><div class="password-row"><input id="password-input" type="password" placeholder="Enter password" /><button id="password-submit" class="btn">Unlock</button></div><div id="password-error" style="margin-top:8px;color:#f66;display:none;"></div></div><div id="player-block" style="display:none;margin-top:12px;"><div id="player-wrap"></div></div></div></div></div>`;
  document.getElementById('modal-close').onclick = closeModal;
  document.getElementById('password-submit').onclick = onPasswordSubmit;
  document.getElementById('password-input').onkeydown = (e)=>{ if(e.key === 'Enter') onPasswordSubmit(); };
  document.getElementById('modal-backdrop').onclick = function(e){ if(e.target === this) closeModal(); };
}

function showUnlockedItem(item) {
  if(!window.__viduGlobal) window.__viduGlobal = {};
  window.__viduGlobal.visualsPaused = true;
  window.dispatchEvent(new CustomEvent('vidu:visuals:pause', { detail:{ reason:'modal-open' } }));

  if (item.type === 'playlist') {
    openFullScreenPlaylist(item);
  } else {
    const id = decodeEnc(item.idEnc || '');
    playVideoWithLoading({ videoId: id, title: item.name || 'Video' });
  }
}

function openPasswordModal(item){
  currentItem = item;
  const root = document.getElementById('modal-root');
  root.style.display = 'block';
  document.getElementById('modal-title').textContent = item.name || 'Protected';
  document.getElementById('modal-subtitle').textContent = (item.type || 'video') + ' — password required';
  document.getElementById('password-input').value = '';
  document.getElementById('password-error').style.display = 'none';
  document.getElementById('password-block').style.display = 'block';
  document.getElementById('player-block').style.display = 'none';
  setTimeout(()=>document.getElementById('password-input').focus(), 50);
  if(!window.__viduGlobal) window.__viduGlobal = {};
  window.__viduGlobal.visualsPaused = true;
  window.dispatchEvent(new CustomEvent('vidu:visuals:pause', { detail:{ reason:'modal-open' } }));
}

function closeModal(){
  const root = document.getElementById('modal-root');
  if(root) root.style.display = 'none';
  
  if(window.destroyViduPlayer) try{ window.destroyViduPlayer(); }catch(e){}

  if (currentItem && currentItem.type === 'playlist') {
    const fsPlaylist = document.getElementById('fullscreen-playlist-overlay');
    if (fsPlaylist) fsPlaylist.classList.add('show');
  } else {
    currentItem = null;
    resumeVisuals('modal-closed');
  }
}

function onPasswordSubmit(){
  const val = (document.getElementById('password-input').value || '').trim();
  if(!currentItem) return;
  const expected = b64decode(currentItem.passEnc || '');
  if(val === expected){
    const root = document.getElementById('modal-root');
    if(root) root.style.display = 'none';
    showUnlockedItem(currentItem);
  } else {
    const err = document.getElementById('password-error'); err.style.display = 'block'; err.textContent = 'Incorrect password — try again.';
  }
}

const YT_API_KEY = 'AIzaSyB8UVKOZOnUnYdqbFGOtlg6BPfR9HpD35c';
async function fetchPlaylistVideos(playlistId){
  if(!YT_API_KEY || YT_API_KEY === 'YOUR_API_KEY_HERE') throw new Error('No API key configured.');
  if (currentPlaylistCache[playlistId]) return currentPlaylistCache[playlistId];
  
  const items=[]; let pageToken='';
  do{
    const url = `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId=${encodeURIComponent(playlistId)}&key=${encodeURIComponent(YT_API_KEY)}` + (pageToken?`&pageToken=${pageToken}`:'');
    const res = await fetch(url);
    if(!res.ok){ const txt = await res.text().catch(()=>null); throw new Error(`YouTube API error: ${res.status} ${txt||''}`); }
    const data = await res.json();
    (data.items||[]).forEach(it=>{
      const sn = it.snippet || {};
      if(sn.resourceId && sn.resourceId.videoId && sn.title !== 'Private video' && sn.title !== 'Deleted video'){
        const thumb = (sn.thumbnails && (sn.thumbnails.high||sn.thumbnails.medium||sn.thumbnails.default))||{};
        items.push({ videoId: sn.resourceId.videoId, title: sn.title||'Untitled', thumb: thumb.url||`https://img.youtube.com/vi/${sn.resourceId.videoId}/hqdefault.jpg` });
      }
    });
    pageToken = data.nextPageToken || '';
  } while(pageToken);
  currentPlaylistCache[playlistId] = items;
  return items;
}

async function openFullScreenPlaylist(item) {
  const overlay = document.getElementById('fullscreen-playlist-overlay');
  const titleEl = document.getElementById('fs-playlist-title');
  const countEl = document.getElementById('fs-playlist-count');
  const contentEl = document.getElementById('fs-playlist-content');
  const loaderEl = document.getElementById('fs-playlist-loader');
  
  titleEl.textContent = item.name || 'Playlist';
  countEl.textContent = '... Videos';
  contentEl.innerHTML = '';
  loaderEl.style.display = 'flex';
  overlay.classList.add('show');
  
  const rawId = decodeEnc(item.idEnc);
  const playlistId = rawId.split('&')[0];

  try {
    const videos = await fetchPlaylistVideos(playlistId);
    renderFullScreenPlaylist(videos, item.name);
  } catch (err) {
    console.error('Playlist fetch error', err);
    contentEl.innerHTML = `<p style="text-align:center; color: var(--muted);">Failed to load playlist: ${escapeHtml(err.message)}</p>`;
  } finally {
    loaderEl.style.display = 'none';
  }
}

function renderFullScreenPlaylist(videos, title) {
  const titleEl = document.getElementById('fs-playlist-title');
  const countEl = document.getElementById('fs-playlist-count');
  const contentEl = document.getElementById('fs-playlist-content');

  titleEl.textContent = title || 'Playlist';
  countEl.textContent = `${videos.length} Videos`;
  contentEl.innerHTML = '';
  
  const fragment = document.createDocumentFragment();
  videos.forEach(video => {
    const li = document.createElement('div');
    li.className = 'fs-playlist-item';
    li.innerHTML = `<img src="${escapeHtml(video.thumb)}" alt="${escapeHtml(video.title)}" loading="lazy" /><div class="title">${escapeHtml(video.title)}</div>`;
    li.onclick = () => playVideoWithLoading({ videoId: video.videoId, title: video.title });
    fragment.appendChild(li);
  });
  contentEl.appendChild(fragment);
}

function playVideoWithLoading(videoInfo) {
  const fsPlaylist = document.getElementById('fullscreen-playlist-overlay');
  const loadingPopup = document.getElementById('player-loading-overlay');
  const loadingBar = document.getElementById('player-loading-bar-fill');

  fsPlaylist.classList.remove('show');
  
  loadingBar.style.transition = 'none';
  loadingBar.style.width = '0%';
  loadingPopup.classList.add('show');

  setTimeout(() => {
    loadingBar.style.transition = 'width 2s cubic-bezier(0.4, 0, 0.2, 1)';
    loadingBar.style.width = '100%';
  }, 50);

  setTimeout(() => {
    loadingPopup.classList.remove('show');

    const root = document.getElementById('modal-root');
    root.style.display = 'block';
    document.getElementById('modal-title').textContent = videoInfo.title;
    document.getElementById('modal-subtitle').textContent = 'Now Playing';
    document.getElementById('password-block').style.display = 'none';
    document.getElementById('player-block').style.display = 'block';
    
    if (window.showViduPlayer) {
      window.showViduPlayer(videoInfo.videoId).catch(err => {
        console.error('showViduPlayer failed', err);
        const wrap = document.getElementById('player-wrap');
        if (wrap) wrap.innerHTML = `<div class="muted">Failed to load player: ${escapeHtml(err.message || '')}</div>`;
      });
    }

    setTimeout(() => {
        loadingBar.style.transition = 'none';
        loadingBar.style.width = '0%';
    }, 300);
  }, 2000);
}

function pauseVisuals(reason){ if(!window.__viduGlobal) window.__viduGlobal = {}; window.__viduGlobal.visualsPaused = true; }
function resumeVisuals(reason){ if(!window.__viduGlobal) window.__viduGlobal = {}; window.__viduGlobal.visualsPaused = false; }

document.addEventListener('DOMContentLoaded', function(){
  createModal();
  renderPlaylists();
  
  document.getElementById('fs-playlist-close-btn').addEventListener('click', () => {
    document.getElementById('fullscreen-playlist-overlay').classList.remove('show');
    currentItem = null;
    resumeVisuals('playlist-closed');
  });
});

document.addEventListener('contextmenu', e => e.preventDefault(), false);
document.addEventListener('keydown', e => { if ((e.ctrlKey && e.shiftKey && (e.key==='I'||e.key==='i'||e.key==='J'||e.key==='j')) || (e.ctrlKey && (e.key==='U'||e.key==='u')) || (e.key==='F12')) e.preventDefault(); });
document.addEventListener('keydown', e => { 
    if (e.key === 'Escape') { 
        const root = document.getElementById('modal-root'); 
        const fsPlaylist = document.getElementById('fullscreen-playlist-overlay');
        if (root && root.style.display !== 'none') closeModal();
        else if (fsPlaylist && fsPlaylist.classList.contains('show')) {
            fsPlaylist.classList.remove('show');
            currentItem = null;
            resumeVisuals('esc');
        }
    } 
});

</script>

<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/browser.min.js"></script>
<script src="assets/js/breakpoints.min.js"></script>
<script src="assets/js/util.js"></script>
<script src="assets/js/main.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Notification Panel Logic
    const notificationBtn = document.getElementById('notification-btn');
    const notificationPanel = document.getElementById('notification-panel');
    const notificationCloseBtn = document.getElementById('notification-close-btn');
    if (notificationBtn && notificationPanel && notificationCloseBtn) {
        function showPanel() { notificationPanel.classList.add('show'); notificationPanel.setAttribute('aria-hidden', 'false'); }
        function hidePanel() { notificationPanel.classList.remove('show'); notificationPanel.setAttribute('aria-hidden', 'true'); }
        notificationBtn.addEventListener('click', (event) => { event.stopPropagation(); notificationPanel.classList.contains('show') ? hidePanel() : showPanel(); });
        notificationCloseBtn.addEventListener('click', hidePanel);
        document.addEventListener('click', (event) => { if (notificationPanel.classList.contains('show') && !notificationPanel.contains(event.target) && !notificationBtn.contains(event.target)) hidePanel(); });
        document.addEventListener('keydown', (event) => { if (event.key === 'Escape' && notificationPanel.classList.contains('show')) hidePanel(); });
    }

    // Download loading popup logic
    const downloadBtn = document.getElementById('download-btn-header');
    const loadingPopup = document.getElementById('loading-popup-overlay');
    const loadingBar = document.getElementById('loading-bar-fill');
    if (downloadBtn && loadingPopup && loadingBar) {
        downloadBtn.addEventListener('click', () => {
            const url = downloadBtn.dataset.link;
            loadingBar.style.transition = 'none';
            loadingBar.style.width = '0%';
            loadingPopup.classList.add('show');
            setTimeout(() => { loadingBar.style.transition = 'width 3s linear'; loadingBar.style.width = '100%'; }, 50);
            setTimeout(() => {
                window.open(url, '_blank', 'noopener,noreferrer');
                loadingPopup.classList.remove('show');
                setTimeout(() => { loadingBar.style.transition = 'none'; loadingBar.style.width = '0%'; }, 300);
            }, 3000);
        });
    }
});
</script>
</body>
</html>
